<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Friend Finder Survey</title>
    <link rel="icon" type="image/x-icon" href="./app/public/favicon.png">

    <!--Font awesome and google fonts-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ"
        crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">

</head>

<body style="border: 0; padding: 0; margin: 0; background-color: rgb(9, 9, 214);">
    <!--Wrapper to facilitate placement-->
    <div style="height: 100vh; width: 100%;">

        <!--div to contain the survey and provide spacing from the sides-->
        <div style="width: 80%; margin-left: 10%; margin-top: 1%;">

            <!--survey header and initial text inputs-->
            <h1 style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94); border-bottom: 1px solid gray;">Survey Questions</h1>
            <h2 style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">About You</h2>
            <h3 style="margin-left: 2%; color: #F64C72; font-size: 15px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">All fields on this page are required</h3>
            <label style="margin-left: 2%; color: #F64C72; font-size: 25px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">Name</label>
            <br>
            <input id="name" type="text" style="margin-left: 2%; font-family: 'Montserrat'; width: 60%;">
            <br>
            <label style="margin-left: 2%; color: #F64C72; font-size: 25px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">Link to a Photo</label>
            <br>
            <input id="photo" type="text" style="margin-left: 2%; font-family: 'Montserrat'; width: 60%;">
            <br>
            <div style="border-bottom: 1px solid gray; margin-top: 1%;"></div>

            <!--questions section of survey. Options use a dropdown menu from bootstrap-->
            <h2 style="margin-left: 2%; margin-top: 1%; color: #F64C72; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">Questions</h2>

            <label style="margin-left: 2%; color: #F64C72; font-size: 20px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">1. You generally like to go out to social events instead of staying home.</label>
            <br>
            <div class="input-group mb-3" style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; width: 15%;">
                <select class="custom-select" id="question1">
                    <option selected>Choose...</option>
                    <option value="1">Strongly Disagree</option>
                    <option value="2">Disagree</option>
                    <option value="3">Neutral</option>
                    <option value="4">Agree</option>
                    <option value="5">Strongly Agree</option>
                </select>
            </div>

            <label style="margin-left: 2%; color: #F64C72; font-size: 20px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">2. You get along with almost everyone.</label>
            <br>
            <div class="input-group mb-3" style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; width: 15%;">
                <select class="custom-select" id="question2">
                    <option selected>Choose...</option>
                    <option value="1">Strongly Disagree</option>
                    <option value="2">Disagree</option>
                    <option value="3">Neutral</option>
                    <option value="4">Agree</option>
                    <option value="5">Strongly Agree</option>
                </select>
            </div>

            <label style="margin-left: 2%; color: #F64C72; font-size: 20px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">3. You enjoy active outdoor activities, such as hiking or kayaking.</label>
            <br>
            <div class="input-group mb-3" style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; width: 15%;">
                <select class="custom-select" id="question3">
                    <option selected>Choose...</option>
                    <option value="1">Strongly Disagree</option>
                    <option value="2">Disagree</option>
                    <option value="3">Neutral</option>
                    <option value="4">Agree</option>
                    <option value="5">Strongly Agree</option>
                </select>
            </div>

            <label style="margin-left: 2%; color: #F64C72; font-size: 20px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">4. When watching movies, you prefer action over drama.</label>
            <br>
            <div class="input-group mb-3" style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; width: 15%;">
                <select class="custom-select" id="question4">
                    <option selected>Choose...</option>
                    <option value="1">Strongly Disagree</option>
                    <option value="2">Disagree</option>
                    <option value="3">Neutral</option>
                    <option value="4">Agree</option>
                    <option value="5">Strongly Agree</option>
                </select>
            </div>

            <label style="margin-left: 2%; color: #F64C72; font-size: 20px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">5. If someone around you cuts you off, you generally speed up to cut them off for revenge.</label>
            <br>
            <div class="input-group mb-3" style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; width: 15%;">
                <select class="custom-select" id="question5">
                    <option selected>Choose...</option>
                    <option value="1">Strongly Disagree</option>
                    <option value="2">Disagree</option>
                    <option value="3">Neutral</option>
                    <option value="4">Agree</option>
                    <option value="5">Strongly Agree</option>
                </select>
            </div>

            <label style="margin-left: 2%; color: #F64C72; font-size: 20px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">6. You generally enjoy having an alcoholic beverage with dinner.</label>
            <br>
            <div class="input-group mb-3" style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; width: 15%;">
                <select class="custom-select" id="question6">
                    <option selected>Choose...</option>
                    <option value="1">Strongly Disagree</option>
                    <option value="2">Disagree</option>
                    <option value="3">Neutral</option>
                    <option value="4">Agree</option>
                    <option value="5">Strongly Agree</option>
                </select>
            </div>

            <label style="margin-left: 2%; color: #F64C72; font-size: 20px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">7. Kittens are cuter than puppies.</label>
            <br>
            <div class="input-group mb-3" style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; width: 15%;">
                <select class="custom-select" id="question7">
                    <option selected>Choose...</option>
                    <option value="1">Strongly Disagree</option>
                    <option value="2">Disagree</option>
                    <option value="3">Neutral</option>
                    <option value="4">Agree</option>
                    <option value="5">Strongly Agree</option>
                </select>
            </div>

            <label style="margin-left: 2%; color: #F64C72; font-size: 20px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">8. When playing board games, the more complicated, the better.</label>
            <br>
            <div class="input-group mb-3" style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; width: 15%;">
                <select class="custom-select" id="question8">
                    <option selected>Choose...</option>
                    <option value="1">Strongly Disagree</option>
                    <option value="2">Disagree</option>
                    <option value="3">Neutral</option>
                    <option value="4">Agree</option>
                    <option value="5">Strongly Agree</option>
                </select>
            </div>

            <label style="margin-left: 2%; color: #F64C72; font-size: 20px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">9. You are an adventurous eater.</label>
            <br>
            <div class="input-group mb-3" style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; width: 15%;">
                <select class="custom-select" id="question9">
                    <option selected>Choose...</option>
                    <option value="1">Strongly Disagree</option>
                    <option value="2">Disagree</option>
                    <option value="3">Neutral</option>
                    <option value="4">Agree</option>
                    <option value="5">Strongly Agree</option>
                </select>
            </div>

            <label style="margin-left: 2%; color: #F64C72; font-size: 20px; font-family: 'Montserrat'; text-shadow: 1px 1px rgb(45, 2, 94);">10. You generally prefer a concert over a sporting event.</label>
            <br>
            <div class="input-group mb-3" style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat'; width: 15%;">
                <select class="custom-select" id="question10">
                    <option selected>Choose...</option>
                    <option value="1">Strongly Disagree</option>
                    <option value="2">Disagree</option>
                    <option value="3">Neutral</option>
                    <option value="4">Agree</option>
                    <option value="5">Strongly Agree</option>
                </select>
            </div>

                <!--Button to submit user input-->
            <button id="submit-button" type="submit" style="background-color: #242582; height: 50px; width: 96%; text-align: center; font-size: 20px; font-family: 'Montserrat'; padding-top: 7px; margin: 20px auto 20px 2%; color: #F64C72; position: relative; border: 2px solid rgba(255, 255, 255, 0.801); box-shadow: 2px 2px black; cursor: pointer; text-shadow: 1px 1px rgb(54, 4, 92);">Match me with a friend!</button>
            <div style="border-bottom: 1px solid gray; margin-top: 1%; margin-bottom: 1%;"></div>

            <!--footer... a bit self explanatory-->
            <footer style="position: relative; bottom: 0; width: 100%; height: 50px;">
                <p style="margin-left: 2%; color: #F64C72; font-family: 'Montserrat';">
                    <a href="/api/friendlist" style=" color: #F64C72;">API Friend List</a> |
                    <a href="https://github.com/joeyvon2434/friend-finder" style=" color: #F64C72;">GitHub Repo</a>
                </p>
            </footer>
        </div>
<!--Section with modals-->
        <!--Modal for validation. Ensures user has input all information-->
        <div id="info-missing" class="modal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Required data is missing!</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span id='close-x' aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p>All fields are require. Please fill out all fields to continue.</p>
                    </div>
                    <div class="modal-footer">
                        <button id="close-button" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <!--Modal for the friend match-->
        <div id="match-modal" class="modal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 id="match-name" class="modal-title">Cow</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span id='close-x-match' aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <img id="match-photo" alt="pic of your match" src="https://us-east-1.tchyn.io/snopes-production/uploads/2017/11/cow_fb.jpg?resize=865%2C452"
                            style="max-width: 90%;">
                    </div>
                    <div class="modal-footer">
                        <button id="close-button-match" type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>


    </div><!--Closes the wrapper div-->

    <!-- JQuery link-->
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    
    <!--Javascript to interact with server and for local file actions-->
    <script>

        //Survey submission button
        $("#submit-button").on('click', function () {
            event.preventDefault();

            //creates an object with the users input
            var newFriend = {
                name: $("#name").val(),
                imageLink: $("#photo").val().trim(),
                scores: [$('#question1').val(), $('#question2').val(), $('#question3').val(), $('#question4').val(), $('#question5').val(), $('#question6').val(), $('#question7').val(), $('#question8').val(), $('#question9').val(), $('#question10').val()]
            };

            //validation variable for survey questions
            var allowPost = true;

            //ensure all survey questions are answered, or set the allowPost variable to false
            for (var i = 0; i < newFriend.scores.length; i++) {
                if (newFriend.scores[i] == 'Choose...') {
                    allowPost = false;
                }
            };

            //ensure all posting criteria are met. AKA, all fields have been completed
            if (newFriend.name !== '' && newFriend.imageLink !== '' && allowPost == true) {

                //send post request to the survey and receive a response
                $.post("/api/friendlist", newFriend, function (data) {
                    //console.log("survey.html", data);
                }).then(function (data) {


                    //empty survey fields when a valid submission is made
                    $("#name").val('');
                    $("#photo").val('');
                    $('#question1').val('Choose...');
                    $('#question2').val('Choose...');
                    $('#question3').val('Choose...');
                    $('#question4').val('Choose...');
                    $('#question5').val('Choose...');
                    $('#question6').val('Choose...');
                    $('#question7').val('Choose...');
                    $('#question8').val('Choose...');
                    $('#question9').val('Choose...');
                    $('#question10').val('Choose...');

                    //get name and photo of the match from the server response and populate the match fields locally
                    $('#match-name').text(data.name);
                    $('#match-photo').attr('src', data.photo);

                    //show the match modal with results frothe user
                    $('#match-modal').show();
                });
            } else {
                $('#info-missing').show();

            }//end if statement to allow post


        }); // end click function to match to friend


        //Functions to close modals
        ///////////////////////////////////////////
        $('#close-button').on('click', function () {
            event.preventDefault();
            $('#info-missing').hide();
        });

        $('#close-x').on('click', function () {
            event.preventDefault();
            $('#info-missing').hide();
        });

        $('#close-button-match').on('click', function () {
            event.preventDefault();
            $('#match-modal').hide();
        });

        $('#close-x-match').on('click', function () {
            event.preventDefault();
            $('#match-modal').hide();
        });

    </script>
</body>

</html>